<!doctype html>
<html class="no-js" lang="ko">
<head>
  <meta charset="utf-8">
  <meta name="generator" content="Hugo 0.78.1" />

  <title> serverless framework plugins &middot; /usr/lib/libsora.so </title>

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="naver-site-verification" content="2ddc1a56777489f4a64a4f6a59822f8b1c1ea502"/>
  <meta name="google-site-verification" content="VsvNNnJZUV-iLEYKNju16p-HtDqZeqL15H-VVy-HwpA" />

  <meta name="gc:client-id" content="785d47c81cbc2fd42b65">
  <meta name="gc:client-secret" content="5e5d558f0b16fae154aa47fc9d94f7c09e540ec7">

  
  <meta name="author" content="if1live" />
  

  
  <meta name="description" content="serverless framework plugins" />
  

  
  <meta name="keywords" content="serverless" />
  

  
  
<meta name="twitter:card" content="summary">
<meta name="og:url" content="https://libsora.so/posts/serverless-framework-plugins/">

<meta name="twitter:site" content="@if1live">


<meta name="twitter:title" content="serverless framework plugins">
<meta name="twitter:description" content="개요 serverless framework은 aws lambda 같은 서버리스 플랫폼에 배포할때 유용한 도구이다. 하지만 serverless framework를 그대로 쓰는건 불편하다. 다행히도 serverless에는 플러그인이 많이 있고 적절한걸 붙이면 많이 편해진다.
내가 사용 중인 serverless 플러그인을 정리해봤다. 사용법은 각각의 README">

<meta name="twitter:image:src" content="https://www.gravatar.com/avatar/fb9672e7e0d256f39369595381d1ea07">



  

  
  
  <link rel="stylesheet" href="https://libsora.so/css/style-gen.css?2">

  
  <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />

  
  <link href="https://libsora.so/index.xml" rel="alternate" type="application/rss+xml" title="/usr/lib/libsora.so" />

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.22.0/themes/prism.min.css"
  integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
  crossorigin="anonymous" />
<link rel="stylesheet"
  href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.22.0/plugins/line-numbers/prism-line-numbers.min.css"
  integrity="sha512-cbQXwDFK7lj2Fqfkuxbo5iD1dSbLlJGXGpfTDqbggqjHJeyzx88I3rfwjS38WJag/ihH7lzuGlGHpDBymLirZQ=="
  crossorigin="anonymous" />

  
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.css"
  integrity="sha512-h7nl+xz8wgDlNM4NqKEM4F1NkIRS17M9+uJwIGwuo8vGqIl4BhuCKdxjWEINm+xyrUjNCnK5dCrhM0sj+wTIXw=="
  crossorigin="anonymous" />


  
  <script type="text/javascript">
    var host = "libsora.so";
    if ((host == window.location.host) && (window.location.protocol != "https:")) {
      window.location.protocol = "https";
    } else {
      console.log("skip https redirect");
    }
  </script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>
(adsbygoogle = window.adsbygoogle || []).push({
  google_ad_client: "ca-pub-3043297488880636",
  enable_page_level_ads: true
});
</script>

</head>
<body>

<header class="header">
  <h1 class="font-monospace">
    <a href="https://libsora.so/">/usr/lib/libsora.so</a>
  </h1>
  <nav>
    <h2 hidden>Navigation</h2>
    <ul class="nav-link-list">
      <li>
        <a href="https://libsora.so/about/"  title="about">
          <i class="fa fa-info"><span hidden>about</span></i>
        </a>
      </li>
      <li>
        <a href="https://libsora.so/projects/"  title="projects">
          <i class="fa fa-code"><span hidden>projects</span></i>
        </a>
      </li>
      <li>
        <a href="https://libsora.so/archives/"  title="archives">
          <i class="fa fa-archive"><span hidden>Archives</span></i>
        </a>
      </li>
      <li>
        <a href="https://libsora.so/tags/"  title="tags">
          <i class="fa fa-tags"><span hidden>Tags</span></i>
        </a>
      </li>
      <li>
        <a href="https://libsora.so/search/"  title="search">
          <i class="fa fa-search"><span hidden>Search</span></i>
        </a>
      </li>
    </ul>
  </nav>
</header>


<div class="container">
  <article class="basic-content article-content">
    <header>
      <hgroup class="entry-title">
        <a href="/posts/serverless-framework-plugins/" rel="bookmark" title="Permalink to serverless framework plugins">
          <h1>serverless framework plugins</h1>
          
          <h2>내가 쓰는 플러그인과 이유</h2>
          
        </a>
      </hgroup>
    </header>

    <footer class="post-info">
      <abbr class="published" title='2020-01-01T00:00:00Z'>
        2020/01/01
      </abbr>
      
      <address class="vcard author">
        By <a href="//twitter.com/if1live">@if1live</a>
      </address>
      

      <ul class="list-of-tags tags-in-article">
        
        <li>
          <a href="/tags/serverless">#serverless</a>
        </li>
        
      </ul>
    </footer>

    <section class="entry-content">
      <h2 id="개요">개요</h2>
<p>serverless framework은 aws lambda 같은 서버리스 플랫폼에 배포할때 유용한 도구이다.
하지만 serverless framework를 그대로 쓰는건 불편하다.
다행히도 serverless에는 플러그인이 많이 있고 적절한걸 붙이면 많이 편해진다.</p>
<p>내가 사용 중인 serverless 플러그인을 정리해봤다.
사용법은 각각의 README를 참고하면 되기때문에 다루지 않았다.</p>
<h2 id="serverless-webpackserverless-webpack"><a href="https://github.com/serverless-heaven/serverless-webpack">serverless-webpack</a></h2>
<p>나는 타입스크립트를 사용한다.
serverless에서 타입스크립트 사용하는 방법 찾다가 <a href="https://github.com/prisma-labs/serverless-plugin-typescript">serverless-plugin-typescript</a>를 찾아서 사용했다.
serverless-plugin-typescript는 소개 첫줄부터 zero-config 를 강조하더라.
플러그인만 설치해도 타입스크립트를 쓸 수 있더라.</p>
<p>나중에 더 배우고나니까 serverless가 타입스크립트를 기본적으로 지원하더라.
<code>serverless create --template aws-nodejs-typescript --name xxx</code> 로 프로젝트를 생성시킬 수 있다.
템플릿으로 생성한 프로젝트는 serverless-webpack을 사용하거더라.</p>
<p>지금은 serverless-plugin-typescript를 걷어내고 serverless-webpack를 쓰고있다.</p>
<ol>
<li>webpack은 빌드 과정을 손댈 수 있다. 설정 손대지 않고 프로덕션까지 가는건 쉽지 않다.</li>
<li>webpack은 플러그인이 많다. webpack 생태계에 묻어가면 편하다.</li>
</ol>
<h2 id="serverless-dotenv-pluginserverless-dotenv-plugin"><a href="https://github.com/colynb/serverless-dotenv-plugin">serverless-dotenv-plugin</a></h2>
<p>express 쓰던 시절부터 <a href="https://github.com/motdotla/dotenv">dotenv</a>는 열심히 썼다.
serverless 환경에서도 비슷한게 있어서 갖다썻다.</p>
<h2 id="serverless-domain-managerserverless-domain-manager"><a href="https://github.com/amplify-education/serverless-domain-manager">serverless-domain-manager</a></h2>
<p>aws lambda로 서비스를 배포하면 도메인이 할당된다.
<code>https://xxxxxxxxxx.execute-api.ap-northeast-2.amazonaws.com/</code>
서비스를 지웠다가 다시 배포하면 새로운 도메인이 할당된다.
문제 생겨서 서비스 지웠다 다시 만들면 바뀌며 생긴게 이쁘지 않은 도메인을 프로덕션에서 사용하고 싶진 않았다.</p>
<p>api gateway, route53을 손봐서 사용자 지정 도메인을 연결할수 있다.
하지만 서비스가 한두개도 아니고 스테이지도 한두개가 아니라서 일일히 연결하는건 사람 손으로 할 짓이 아닌거같더라.
도메인 연결을 자동화 시키려고 플러그인을 설치했다.</p>
<h2 id="serverless-layersserverless-layers"><a href="https://github.com/agutoli/serverless-layers">serverless-layers</a></h2>
<p><a href="https://www.slideshare.net/changhoonhyun/aws-sam">AWS SAM을 이용한 모놀리식 서버리스 어플리케이션 운영하기</a>
나도 마이크로서비스의 길을 포기하고 모놀리식(monolithic) 아키텍처로 구현하고 있다.</p>
<p>저장소 하나에 모든 구현을 때려박고 있으니까 package.json이 점점 거대해지고 있다.
typeorm, mysql, express, &hellip; 의존성이 늘어나고 배포 용량도 커지고 있다.
나중에는 배포 한번 할때마다 15MB~20MB가 배포되더라.</p>
<p>내가 짠 코드는 끽해야 100~200kb 밖에 안되고 나머지는 전부 라이브러리이다.
라이브러리는 자주 바뀌지 않는 부분이니까 배포에서 이를 분리하고 싶었다.</p>
<p>serverless-layers를 도입해서 문제를 해결했다.
package.json의 내용이 바뀌었을때는 배포 용량이 20MB이지만 평소에는 1MB보다 훨씬 작다.</p>
<h2 id="serverless-offlineserverless-offline"><a href="https://github.com/dherault/serverless-offline">serverless-offline</a></h2>
<p>serverless로 처음 만든 함수는 REST API였다.
근데 순정 serverless에는 웹서버를 띄울 수 있는 기능이 없다.
내가 만든 REST API를 테스트 하기 위해서는 aws lambda에 배포해야 된다.
로컬에서 테스트 하려면 invoke local을 사용해야 되는데 이것은 매우 불편하다.</p>
<p>serverless-offline이 붙으면 모든게 달라진다.
serverless framework를 로컬에 웹서버로 띄울 수 있다.
개발 과정이 훨씬 편해진다.</p>
<p>가끔 serverless-offline의 동작과 실제 aws lambda의 동작이 달라서 엿먹을때가 있지만 serverless-offline이 없는 것보다는 훨씬 좋다.</p>
<h2 id="serverless-offline-snsserverless-offline-sns"><a href="https://github.com/mj1618/serverless-offline-sns">serverless-offline-sns</a></h2>
<p>localstack을 이용하면 SNS(Simple Notification Service) 를 로컬에 띄워서 테스트할 수 있다.
하지만 나는 docker같은 외부 의존성 없이 SNS 관련 기능을 구현하고 싶었다.
serverless-offline이 있으니까 SNS도 offline 구현체가 있지 않을까 싶어 뒤져보니까 있더라.</p>
<h2 id="serverless-offline-sqsserverless-offline-sqs"><a href="https://github.com/CoorpAcademy/serverless-plugins/tree/master/packages/serverless-offline-sqs">serverless-offline-sqs</a></h2>
<p>비동기로 작업을 처리한후 SNS로 알림을 보내야하는 기능을 얼마전에 구현했다.
aws lambda를 무식하게 사용하면 이렇게 구현할 수 있다.</p>
<ol>
<li>aws lambda 시작</li>
<li>비동기 명령 보내기</li>
<li>x초 대기&hellip; 명령이 처리되었는가?</li>
<li>처리되지 않았으면 다시 대기&hellip;x초 대기후 완료되었는지 확인</li>
<li>완료되었으면 SNS로 이벤트 보내기</li>
<li>aws lambda 종료</li>
</ol>
<p>이는 무식한 구현답게 비용 측면에서 비효율적이다.
람다는 사용 시간 자체가 비용이다.
결과가 끝났는지 확인하기 위해서 람다가 계속 살아있어야한다.
결과가 끝날때까지 기다리는 루프를 다른 식으로 구현하고 싶었다.</p>
<p>SQS(Simple Queue Service)의 delay를 이용해서 구현하면 아래와 같다.</p>
<ol>
<li>aws lambda 시작</li>
<li>비동기 명령 보내기</li>
<li>SQS로 x초 뒤에 처리되는 메세지 넣기</li>
<li>aws lambda 종료</li>
<li>&hellip;(x초 대기)</li>
<li>aws lambda 시작 (sqs에 의해서 호출)</li>
<li>처리되지 않았으면 SQS로 x초 뒤에 처리되는 메세지 넣기</li>
<li>완료되었으면 SNS로 이벤트 보내기</li>
<li>aws lambda 종료</li>
</ol>
<p>대기하는 동안은 돌아가는 aws lambda 함수가 없으니까 과금도 없다.
SQS 역시 SNS처럼 로컬 구현이 있나 뒤져보니까 있더라.</p>
<h2 id="부록-aws-serverless-express">부록: aws-serverless-express</h2>
<p><a href="https://github.com/awslabs/aws-serverless-express">aws-serverless-express</a>는 serverless framework 플러그인은 아니지만 유용하게 쓰고 있다.
aws-serverless-express 관련된 글을 많이 있어서 직접 다루진 않는다.
어차피 남들도 나와 비슷한 이유로 쓰고 있을테니까.</p>
<p><a href="https://devstarsj.github.io/cloud/2017/08/06/aws-serverless-express/">https://devstarsj.github.io/cloud/2017/08/06/aws-serverless-express/</a></p>

    </section>

    <ul class="articles-timeline">
      <li class="previous-article">
        
        <a href="https://libsora.so/posts/review-year-2019/" title="Next: 2019년 마무리">
          2019년 마무리
          
          <br/><small>아무것도 안했는데 벌써 2019년이 끝났어</small>
          
        </a>
        
      </li>

      <li class="next-article">
        
        <a href="https://libsora.so/posts/my-backend-deployment-environment-policy/" title="Previous: 나의 백엔드 배포 환경 정책">
          나의 백엔드 배포 환경 정책
          
          <br/><small>어쩌다 이렇게 되었는가?</small>
          
        </a>
        
      </li>
    </ul>

    <section class="entry-content">
      <section class="disqus-section">
<h1 hidden>Comment</h1>
<div id="disqus_thread"></div>
<script type="text/javascript">
  var host = "libsora.so";
  if (host == window.location.host) {
    var disqus_shortname = 'libsora';
    var disqus_identifier = 'http://libsora.so\/posts\/serverless-framework-plugins\/';

    (function() {
      var dsq = document.createElement('script');
      dsq.type = 'text/javascript';
      dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
  } else {
    console.log("skip disqus");
  }
</script>
<noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="//disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</section>

    </section>
  </article>
</div>

<footer class="footer">
  <ul class="nav-link-list">
    
    
    
    <li>
      
      <a href="//twitter.com/if1live" title="Twitter"><i class="fa fa-twitter"> </i></a>
    </li>
    
    
    
    <li>
      
      <a href="//github.com/if1live" title="GitHub"><i class="fa fa-github"> </i></a>
    </li>
    
    
    
    <li>
      
      <a href="//bitbucket.org/if1live" title="BitBucket"><i class="fa fa-bitbucket"> </i></a>
    </li>
    

    <li>
      
      <a href="https://libsora.so/index.xml"><i class="fa fa-rss"> </i></a>
    </li>

    
  </ul>

  <p>
    <a href="//gohugo.io/" title="Hugo">Hugo</a> |
    
    <a href="//twitter.com/if1live/" title="@if1live">@if1live</a>
    
  </p>
</footer>

<script src="/js/common.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.22.0/prism.min.js"
  integrity="sha512-9+422Bs3A87UkWfp+qV80Nfv9arhbCXKY1rxrF2seorI36mIIstMiuBfyKLF1yH1nnzQkEWq2xrzT4XU3Z+vrA=="
  crossorigin="anonymous"></script>


<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.22.0/plugins/line-numbers/prism-line-numbers.min.js"
  integrity="sha512-1oLZvExT5RaW4q2GgvRPf+XzVVGmsKirfZBRN7aifdOpvZ1L9idEncfMFlfHiQNGBA+Sev+alscSAT/xQ0rwXA=="
  crossorigin="anonymous"></script>


<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.22.0/components/prism-clike.min.js"
  integrity="sha512-/WJ9ZNER39LEXW4XzFoMR6ct++/HT++A71MDW2gBbUJExj8hFRtde5Q5QzcHyBMxU97VeH1wEHGBRtNuGJpV4w=="
  crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.22.0/components/prism-c.min.js"
  integrity="sha512-TO7UeOg1N67oP7UU2OzrOm0oZrTz2TXGNRtkf/x+d9Pt5O8cb5jeSRcryiXqW/Nd25VEc8Qqtu8Dx1EVV7AJLQ=="
  crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.22.0/components/prism-cpp.min.js"
  integrity="sha512-dzF2RO45FHCMPdWDQ3I7Cn9xPvCM8x8T4ODz+kSPQl5CAuIMy6Ekb2i2DAjLEpG/V/DL9f/O7+9E/HZQQx89IA=="
  crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.22.0/components/prism-typescript.min.js"
  integrity="sha512-5KnWNKu6jz8OE4nIBndz3PZ4O3RGqcPNcsyEFZkx3F5N8liSwc3bCe4qPOa/a3+e4CxVl0izHMXeZ0Z4yk7LTA=="
  crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.22.0/components/prism-python.min.js"
  integrity="sha512-EXseTM1JV8e3AonU5PfOUmzbPkUTRm4c4hVxv206gVeWZE/FwzSQBNWrUBaHsN3Idq9k76BEjUlXpluX1UFx6Q=="
  crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.22.0/components/prism-javascript.min.js"
  integrity="sha512-UN3RxBb1KfsWQUMNl19SU/JPer3v8jTBpfGyQaBEuaVjP5q0Gz9ihj8MiHEUZYnc1krYRm5imVebjq1egsSaKA=="
  crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.22.0/components/prism-java.min.js"
  integrity="sha512-p2vAaPEsPvlIESCpoEI5IyzZowfdVZ2O39PsrOrkuTQl+AjD57T4L/Wxv5S8WCToLou0twQZaWO+tt660Rqb6Q=="
  crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.22.0/components/prism-csharp.min.js"
  integrity="sha512-qvSIQfI/qEeMC1E1LMSPCsDl8vFzl0rkBfF6dDcnMJxQT+8M2WjSyDGqHQzZa+RChv3jkdKnZAo99BcAbGsnQg=="
  crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.22.0/components/prism-bash.min.js"
  integrity="sha512-CILPDr/8BlkkElCeI+f2yMu0fzgwWqpQ0Cdr0busFfySJJ4SoCRivbT6+Z+SWPkjWwBil9NO0tHd6NSfpwiQaA=="
  crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.22.0/components/prism-ruby.min.js"
  integrity="sha512-Wgi0cnFpl5EY8xLe1RO+uTsot86wzAbW/BIoqZopPU+8YW79VDqQE9qTe1R+1uhxLsPBHE+nYwACS+eTsE5GtQ=="
  crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.22.0/components/prism-go.min.js"
  integrity="sha512-hVtwzUDz/n7RqQmiQ7xYAJCTTJe5C52Ung+4Kpz2fPRq7nq2h5gHHQe2HRy7f1Tj3OUVgTO5WRx7XuwT624C9Q=="
  crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.22.0/components/prism-less.min.js"
  integrity="sha512-REVnwsprLWmQbtt0WjkS59nMvtKE0olIjUx+N/k3Gqa5WhmrZ7o0ahGhKYnIK6W2+ITg4cQ2UqZkka4RaZSM9Q=="
  crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.22.0/components/prism-scss.min.js"
  integrity="sha512-rAb9BrnkhMpxN7NoOM7WwPa3phfCMMUZw568Tyzlj9frNsdUUeltfCTATD6ccnVLtnERR+ZXS85Ybs7wo9IiTQ=="
  crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.22.0/components/prism-css.min.js"
  integrity="sha512-zDjwO/e5eVa5WfYra8CE827RFyA/nqhp8y4da+geEpAqpCnmfAHopCNobQ9sJeLBMQY0OLB+hT+k6bbb0FhdYQ=="
  crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.22.0/components/prism-json.min.js"
  integrity="sha512-IC7rV8RslChgByOdUFC6ePqOGn+OwJhnKC3S5AezM8DAiOdGhJMwgsIvBChsa2yuxxoPbH2+W/kjNUM1cc+jUQ=="
  crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.22.0/components/prism-yaml.min.js"
  integrity="sha512-j9sRnEoasdNn9OSwsCxjrQi1H55NqBFDJ+oe7me3sIfvDLeTyzvnZXf0eJqL5CvX6rswU2Sld9PnTVQ0Xy2CFQ=="
  crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.22.0/components/prism-batch.min.js"
  integrity="sha512-YzSVmlznJS4QEi5/tSS9iZ/tVFGdQSKO/F2jsofNH+5PifywJfsOtOZaia+URhumCMdXTTG2UZQ4vtBHWids+Q=="
  crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.22.0/components/prism-lisp.min.js"
  integrity="sha512-3c6jwEnUKsrvucb8b9xdDJw13zOdbeP83PvlSKeoTCCWGacG03MUWHCcBev2NKHA+w8IAWZsGXBcNMaIH/VWYA=="
  crossorigin="anonymous"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/mermaid/8.8.3/mermaid.min.js"
  integrity="sha512-+TNmhaRJf3jyYHTpzEq/5I6b+aGyhzWb21mGdHAjxSGSYwxN9Grug3Y3B9qVxWfKKY8MscE/6mr9walWvFLFvQ=="
  crossorigin="anonymous"></script>

<script>
  mermaid.initialize({ startOnLoad: true });

  (function () {
    const elems = document.querySelectorAll('code.language-mermaid');
    for (let i = 0; i < elems.length; i++) {
      const id = `mermaid-${i}`;
      const elem = elems[i];
      const source = elem.innerText;
      const cb = (svg) => {
        const div = document.createElement('div');
        div.innerHTML = svg;
        elem.parentElement.replaceWith(div);
      };
      mermaid.render(id, source, cb);
    }
  })();
</script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.js"
  integrity="sha512-/CMIhXiDA3m2c9kzRyd97MTb3MC6OVnx4TElQ7fkkoRghwDf6gi41gaT1PwF270W6+J60uTmwgeRpNpJdRV6sg=="
  crossorigin="anonymous"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/contrib/auto-render.min.js"
  integrity="sha512-Do7uJAaHZm5OLrIv/yN4w0iG1dbu01kzdMNnFfu/mAqgUk6Nniv2JYHcwH+cNwjqgLcqcuBBk+JRvprLVI8azg=="
  crossorigin="anonymous"></script>

<script>
  renderMathInElement(document.body,
    {
      delimiters: [
        { left: "$$", right: "$$", display: true },
        { left: "$", right: "$", display: false },
      ]
    }
  );

  var inlineMathArray = document.querySelectorAll("script[type='math/tex']");
  for (var i = 0; i < inlineMathArray.length; i++) {
    var inlineMath = inlineMathArray[i];
    var tex = inlineMath.innerText || inlineMath.textContent;
    var replaced = document.createElement("span");
    replaced.innerHTML = katex.renderToString(tex, { displayMode: false });
    inlineMath.parentNode.replaceChild(replaced, inlineMath);
  }

  var displayMathArray = document.querySelectorAll("script[type='math/tex; mode=display']");
  for (var i = 0; i < displayMathArray.length; i++) {
    var displayMath = displayMathArray[i];
    var tex = displayMath.innerHTML;
    var replaced = document.createElement("span");
    replaced.innerHTML = katex.renderToString(tex.replace(/%.*/g, ''), { displayMode: true });
    displayMath.parentNode.replaceChild(replaced, displayMath);
  }
</script>


<script>
  var host = "libsora.so";
  if (host == window.location.host) {
    window.ga=function(){ga.q.push(arguments)};ga.q=[];ga.l=+new Date;
    ga('create','UA-37862172-2','auto');ga('send','pageview')
  } else {
    console.log("skip google analytics");
  }
</script>
<script src="https://www.google-analytics.com/analytics.js" async defer></script>


</body>
</html>

