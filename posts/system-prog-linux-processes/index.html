<!doctype html>
<html class="no-js" lang="ko">
<head>
  <meta charset="utf-8">
  <meta name="generator" content="Hugo 0.78.1" />

  <title> Linux Processes &middot; /usr/lib/libsora.so </title>

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="naver-site-verification" content="2ddc1a56777489f4a64a4f6a59822f8b1c1ea502"/>
  <meta name="google-site-verification" content="VsvNNnJZUV-iLEYKNju16p-HtDqZeqL15H-VVy-HwpA" />

  <meta name="gc:client-id" content="785d47c81cbc2fd42b65">
  <meta name="gc:client-secret" content="5e5d558f0b16fae154aa47fc9d94f7c09e540ec7">

  
  <meta name="author" content="if1live" />
  

  
  <meta name="description" content="Linux Processes" />
  

  
  <meta name="keywords" content="linux, system programming, process, study" />
  

  
  
<meta name="twitter:card" content="summary">
<meta name="og:url" content="https://libsora.so/posts/system-prog-linux-processes/">

<meta name="twitter:site" content="@if1live">


<meta name="twitter:title" content="Linux Processes">
<meta name="twitter:description" content="시스템 프로그래밍 시험 공부하면서 정리한 내용이다. 내용 갱신은 없을 예정이다.
Linux Processes Processor Execution Modes  Dual Mode Operation  User Mode  Level 3  권한 제한되어있음 일반적인 프로그램    Kernel Mode  Level 0  커널의 모든 영역 접근 가능   진입방법  sy">

<meta name="twitter:image:src" content="https://www.gravatar.com/avatar/fb9672e7e0d256f39369595381d1ea07">



  

  
  
  <link rel="stylesheet" href="https://libsora.so/css/style-gen.css?2">

  
  <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />

  
  <link href="https://libsora.so/index.xml" rel="alternate" type="application/rss+xml" title="/usr/lib/libsora.so" />

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.22.0/themes/prism.min.css"
  integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
  crossorigin="anonymous" />
<link rel="stylesheet"
  href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.22.0/plugins/line-numbers/prism-line-numbers.min.css"
  integrity="sha512-cbQXwDFK7lj2Fqfkuxbo5iD1dSbLlJGXGpfTDqbggqjHJeyzx88I3rfwjS38WJag/ihH7lzuGlGHpDBymLirZQ=="
  crossorigin="anonymous" />

  
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.css"
  integrity="sha512-h7nl+xz8wgDlNM4NqKEM4F1NkIRS17M9+uJwIGwuo8vGqIl4BhuCKdxjWEINm+xyrUjNCnK5dCrhM0sj+wTIXw=="
  crossorigin="anonymous" />


  
  <script type="text/javascript">
    var host = "libsora.so";
    if ((host == window.location.host) && (window.location.protocol != "https:")) {
      window.location.protocol = "https";
    } else {
      console.log("skip https redirect");
    }
  </script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>
(adsbygoogle = window.adsbygoogle || []).push({
  google_ad_client: "ca-pub-3043297488880636",
  enable_page_level_ads: true
});
</script>

</head>
<body>

<header class="header">
  <h1 class="font-monospace">
    <a href="https://libsora.so/">/usr/lib/libsora.so</a>
  </h1>
  <nav>
    <h2 hidden>Navigation</h2>
    <ul class="nav-link-list">
      <li>
        <a href="https://libsora.so/about/"  title="about">
          <i class="fa fa-info"><span hidden>about</span></i>
        </a>
      </li>
      <li>
        <a href="https://libsora.so/projects/"  title="projects">
          <i class="fa fa-code"><span hidden>projects</span></i>
        </a>
      </li>
      <li>
        <a href="https://libsora.so/archives/"  title="archives">
          <i class="fa fa-archive"><span hidden>Archives</span></i>
        </a>
      </li>
      <li>
        <a href="https://libsora.so/tags/"  title="tags">
          <i class="fa fa-tags"><span hidden>Tags</span></i>
        </a>
      </li>
      <li>
        <a href="https://libsora.so/search/"  title="search">
          <i class="fa fa-search"><span hidden>Search</span></i>
        </a>
      </li>
    </ul>
  </nav>
</header>


<div class="container">
  <article class="basic-content article-content">
    <header>
      <hgroup class="entry-title">
        <a href="/posts/system-prog-linux-processes/" rel="bookmark" title="Permalink to Linux Processes">
          <h1>Linux Processes</h1>
          
          <h2>2014년 2학기 시스템 프로그래밍 시험 공부</h2>
          
        </a>
      </hgroup>
    </header>

    <footer class="post-info">
      <abbr class="published" title='2014-10-17T00:00:00Z'>
        2014/10/17
      </abbr>
      
      <address class="vcard author">
        By <a href="//twitter.com/if1live">@if1live</a>
      </address>
      

      <ul class="list-of-tags tags-in-article">
        
        <li>
          <a href="/tags/linux">#linux</a>
        </li>
        
        <li>
          <a href="/tags/system-programming">#system programming</a>
        </li>
        
        <li>
          <a href="/tags/process">#process</a>
        </li>
        
        <li>
          <a href="/tags/study">#study</a>
        </li>
        
      </ul>
    </footer>

    <section class="entry-content">
      <p>시스템 프로그래밍 시험 공부하면서 정리한 내용이다. 내용 갱신은 없을 예정이다.</p>
<h1 id="linux-processes">Linux Processes</h1>
<h2 id="processor-execution-modes">Processor Execution Modes</h2>
<ul>
<li>Dual Mode Operation</li>
</ul>
<h3 id="user-mode">User Mode</h3>
<ul>
<li>Level 3
<ul>
<li>권한 제한되어있음</li>
<li>일반적인 프로그램</li>
</ul>
</li>
</ul>
<h3 id="kernel-mode">Kernel Mode</h3>
<ul>
<li>Level 0
<ul>
<li>커널의 모든 영역 접근 가능</li>
</ul>
</li>
<li>진입방법
<ul>
<li>system call</li>
<li>interrupt</li>
<li>exeception</li>
</ul>
</li>
</ul>
<h3 id="execution-within-user-processes">Execution Within User Processes</h3>
<ul>
<li>커널은 유저 프로세스에 붙어서 작동한다</li>
<li>Mode Switch = user mode &lt;-&gt; kernel mode</li>
<li>0~3GB : User Address Space</li>
<li>3~4GB : Kernel Address Space</li>
<li>User Address Space/Kernel Address Space 이동이 Mode switch</li>
<li>실행 소유권은 유저한테 있다. 커널은 유저측을 빌려서 사용하는 형태</li>
<li>Mode switch overhead는 낮다</li>
</ul>
<h2 id="process프로세스">Process(프로세스)</h2>
<ul>
<li>Process
<ul>
<li>an instance of a running program</li>
</ul>
</li>
</ul>
<h3 id="프로세스의-구조">프로세스의 구조</h3>
<ul>
<li>Images
<ul>
<li>Code : 기계어(.text)</li>
<li>Data : 변수(.data, .bss)</li>
<li>Execution Stack : Stack + Heap</li>
</ul>
</li>
<li>Process Context
<ul>
<li>Program Context
<ul>
<li>data registers</li>
<li>program counter(PC)</li>
<li>stack pointer(SP)</li>
</ul>
</li>
<li>Kernel Context
<ul>
<li>pid, gid, fs, etc&hellip;</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="process-메모리-구조">Process 메모리 구조</h3>
<ul>
<li>.text : program text, code segment, read-only</li>
<li>.data : initialized data,</li>
<li>.bss : uninitialized data, 프로그래 실행 전에 커널이 0으로 초기화</li>
<li>stack : 위에서 밑으로 내려감</li>
<li>heap : 밑에서 위로 올라감</li>
<li>library : stack과 heap 사이에 적절히 위치</li>
</ul>
<h2 id="process--thread-개요">Process / Thread 개요</h2>
<ul>
<li>Process의 구성 요소
<ul>
<li>Process Context</li>
<li>code, data, stack</li>
</ul>
</li>
<li>Thread의 구성 요소
<ul>
<li>Thead Context(쓰레드 별로)</li>
<li>Kernel Context(공유)</li>
<li>code, data, stack</li>
</ul>
</li>
</ul>
<p>Process Context = Program Context + Kernel Context 라는걸 기억하자.
이를 쪼개서 program context(data register, SP, PC)의 이름을 Thread Context로 바꿨을 뿐이다.</p>
<h2 id="process-state">Process State</h2>
<h3 id="general-model">General Model</h3>
<ul>
<li>New
<ul>
<li>-&gt; Ready</li>
</ul>
</li>
<li>Ready
<ul>
<li>-&gt; Dispatch -&gt; Running : Scheduler</li>
</ul>
</li>
<li>Running
<ul>
<li>-&gt; Timeout -&gt; Ready</li>
<li>-&gt; Event Wait -&gt; Blocked</li>
<li>-&gt; Release -&gt; Exit</li>
</ul>
</li>
<li>Blocked(Waiting)
<ul>
<li>예를 들면 I/O 대기</li>
<li>-&gt; Event Occurs -&gt; Ready</li>
</ul>
</li>
<li>Exit</li>
</ul>
<h3 id="linux">Linux</h3>
<ul>
<li>New State가 존재하지 않는다</li>
<li>Ready, Running은 둘다 TASK_RUNNING.</li>
<li>Blocked의 종류가 세분화
<ul>
<li>TASK_INTERRUPTIBLE, TASK_UNINTERRUPTIBLE</li>
<li>TASK_STOPPED</li>
</ul>
</li>
<li>종료는 EXIT_ZOMBIE 를 거쳐서 EXIT_DEAD로</li>
</ul>
<h2 id="process-descriptor">Process Descriptor</h2>
<ul>
<li>PCB(Process Control Block)</li>
<li>task_struct
<ul>
<li>thread_struct : Program Context</li>
<li>mm_struct : code, data, stack</li>
</ul>
</li>
</ul>
<h2 id="process-구분">Process 구분</h2>
<ul>
<li>각각의 프로세스는 고유한 process description를 가짐</li>
<li>PID = Process ID, 프로세스의 고유한 값</li>
<li>0~32767, 근데 커널 컴파일에 따라 다를 수 있음</li>
</ul>
<h2 id="user-stack--kernel-stack">User Stack / Kernel Stack</h2>
<ul>
<li>Dual mode operation =&gt; Stack도 2개
<ul>
<li>user stack, user mode stack</li>
<li>kernel stack, kernel model stack</li>
</ul>
</li>
<li>Mode Switch 발생할때 Stack도 바뀐다</li>
<li>스택을 2개로 분리하는 이유
<ul>
<li>user stack만 존재하면 꽉차서 커널 함수 실행 못할수도 있다</li>
<li>커널 보안</li>
</ul>
</li>
</ul>
<h3 id="user-stack">User Stack</h3>
<ul>
<li>프로세스마다 가진다</li>
<li>높은 주소에서 낮은 주소로</li>
<li>내용물
<ul>
<li>프로그램 종료후의 리턴 주소</li>
<li>프로그램 실행 인자</li>
<li>환경 변수</li>
<li>call stack(함수 인자 + 리턴 주소)</li>
<li>임시 변수</li>
</ul>
</li>
</ul>
<h3 id="kernel-stack">Kernel Stack</h3>
<ul>
<li>커널 모드 진입하기 전에 커널 스택에 실행 상태를 저장한다
<ul>
<li>실행상태 : uesr mode stack(SP)같은거</li>
</ul>
</li>
<li>내용물
<ul>
<li>함수 인자 + 리턴 주소</li>
<li>임시 변수</li>
<li>존재할수 있는것은 user stack와 거의 동일</li>
</ul>
</li>
</ul>
<h3 id="struct-thread_info">struct thread_info</h3>
<ul>
<li>size = 8Kb(페이지 2개 크기)</li>
<li>포로세스마다 하나씩 할당</li>
<li>union을 이용해서 thread_info와 kernel stack을 동시에 사용</li>
</ul>
<h2 id="process-list">Process List</h2>
<h3 id="all-process-list">All Process List</h3>
<ul>
<li>task_struct에 존재하는 tasks로 모든 process description은 연결된다. 이중 링크드 리스트</li>
<li>init_task == process 0, swapper</li>
</ul>
<h3 id="pidhash-table">pidhash Table</h3>
<ul>
<li>0~2047의 해시 테이블</li>
<li>모든 process description가 연결된 링크드 리스트에서 원하는 pid의 process description을 얻는 것은 느리기 때문에 해시테이블 사용한다.</li>
<li>hash collision =&gt; chaining</li>
</ul>
<h3 id="process-관계도">Process 관계도</h3>
<ul>
<li>서로 밀접한 관계가 있는 프로세스도 따로 연결시킨다.</li>
<li>parent</li>
<li>children</li>
<li>sibling</li>
<li>group_leader, thread group leader, &hellip;</li>
</ul>
<h3 id="state">State</h3>
<ul>
<li>TASK_RUNNING
<ul>
<li>실행 상태의 프로세스는 runqueue를 이용해서 연결된다.</li>
<li>스케줄링할때 접근속도를 빠르게 하는것이 목적</li>
<li>자세한 것은 scheduling에서 다룬다</li>
<li>task_struct의 run_list를 이용해서도 연결</li>
</ul>
</li>
<li>TASK_STOPPED, TASK_ZOMBIE
<ul>
<li>특별한 리스트로 연결하지 않는다</li>
</ul>
</li>
<li>TASK_INTERRUPTIBLE, TASK_UNINTERRUPTIBLE
<ul>
<li>여러 자료구조에 연결됨</li>
<li>waiting queue에 연결</li>
</ul>
</li>
</ul>
<h3 id="waiting-queue">Waiting Queue</h3>
<ul>
<li>sleeping processes로 구성됨</li>
<li>특정 조건이 갖춰지면 작업을 깨운다
<ul>
<li>배타적 프로세스, 적절히 하나씩 커널이 깨운다</li>
<li>비배타적 프로세스, 이벤트 들어오면 동시에 깨우기</li>
</ul>
</li>
</ul>
<h2 id="process-switching">Process Switching</h2>
<ul>
<li>발생 조건
<ul>
<li>프로세스가 스스로 잠들었다</li>
<li>프로세스가 종료됨</li>
<li>프로세스가 시스템콜을 끝내고 유저모드로 돌아오는데 프로세스를 돌릴수 있는 상태가 적절한 아니다.</li>
<li>프로세스가 인터럽트 처리를 끝내고 유저모드로 돌아왔는데 우선순위 문제로 실행자격이 없을때
<ul>
<li>time quantum을 전부 썼다</li>
</ul>
</li>
</ul>
</li>
<li>간단한 과정
<ul>
<li>context switch를 할지, 현재 허용되어있는지를 확인</li>
<li>옛날 프로세스의 실행상태를 저장</li>
<li>스케줄링 알고리즘에 따라 스케줄러가 적절히 다음 프로세스를 선택</li>
<li>선택된 프로세스의 실행상태 복구</li>
</ul>
</li>
<li>용어. 전부 같은 뜻
<ul>
<li>task switching</li>
<li>context switching</li>
<li>process switching</li>
</ul>
</li>
<li>상세 절차
<ol>
<li>이전 프로세스의 실행상태(EIP, ESP, &hellip;)를 이전 프로세스의 커널 스택에 저장한다</li>
<li>주소 공간을 다음 프로세스로 변경</li>
<li>kernel mode stack를 다음 프로세스의 것으로 변경</li>
<li>hardware context를 다음 프로세스의 것으로 변경</li>
</ol>
</li>
<li>이후의 내용에서는 3과 4 집중적으로 다움</li>
</ul>
<h3 id="hardware-context">Hardware Context</h3>
<ul>
<li>프로세스를 다시 실행하기전에 CPU 레지스터에 올려야 하는 데이터</li>
<li>thread_struct thread와 커널 스택이 저장
<ul>
<li>eip, esp와 같은것은 thread_struct에 저장</li>
<li>thread_struct에 없는 수많은 레지스터는 커널 스택에 저장</li>
</ul>
</li>
</ul>
<h3 id="process-switch">Process Switch</h3>
<ul>
<li>관련 코드
<ul>
<li><code>schedule()</code> function</li>
<li><code>switch_to()</code> macro</li>
<li><code>__switch_to()</code> macro</li>
</ul>
</li>
<li>switch_to macro 개요
<ul>
<li>CPU 상태를 이전 커널 스택에 저장</li>
<li><strong>esp</strong>를 새로운 프로세스의 것으로 교체</li>
<li><strong>eip</strong>를 새로운 프로세스의 것으로 교체</li>
<li>새로운 프로레스 준비 완료</li>
</ul>
</li>
<li>switch_to macro 상세
<ul>
<li>flags, ebp와 같은 CPU 상태를 prev 커널 스택에 저장</li>
<li>esp를 prev 프로세스 thread_struct의 esp에 저장</li>
<li>next 프로세스 thread_struct에 있는 esp를 esp로</li>
<li>L1을 prev 프로세스 thread_struct의 eip에 저장</li>
<li>next 프로세스 thread_struct에 있는 eip를 스택으로</li>
<li>__switch_to macro. 나머지 hardware context를 저장/교체</li>
<li>L1 : 스택에서 ebp, flags를 빼서 CPU로 저장</li>
</ul>
</li>
</ul>
<h2 id="processthread">Process/Thread</h2>
<ul>
<li>접근법
<ul>
<li>{one|multiple} Process + {one|multiple} Thread</li>
<li>4가지 조합이 가능</li>
</ul>
</li>
<li>전통적인 접근법 : multiple process, one thread
<ul>
<li>각각의 프로세스는 공유되는 것이 없다.</li>
<li>그래서 중복되는게 많다. 비효율적</li>
</ul>
</li>
<li>Thread 구현방법
<ul>
<li>User-level threads
<ul>
<li>한 thread에서 block걸리면 모든 thread가 blocked</li>
</ul>
</li>
<li>Kernel-level threads</li>
<li>combined thread : 잡탕, 패스</li>
</ul>
</li>
</ul>
<h3 id="lightweight-process">Lightweight Process</h3>
<ul>
<li>리눅스에서 Kernel-level Thread를 구현한 방법</li>
<li>자원을 공유하는 process = Lightweight Process</li>
<li>Thread Group, 첫번째 프로세스가 thread group leader</li>
<li>모든 쓰레드는 고유 pid를 갖는다. 모두 독립된 프로세스처럼 취급</li>
<li>TGID(Thread Group ID)가 같으면 한 프로세스에 딸린 쓰레드처럼 취급</li>
</ul>
<h4 id="clone">clone()</h4>
<ul>
<li><code>clone()</code>를 이용해서 <code>fork()</code>, <code>vfork()</code> 구현</li>
<li>flags : parent/chlid간의 공유 리소스 결정. 아무것도 공유하지 않으면 fork</li>
<li>COW(copy-on-write)
<ul>
<li>쓰기할때 진짜로 복사한다. 읽기일때는 page 복사는 없다</li>
<li>복사 overhead 제거</li>
<li>fork했다고 프로세스 전체를 복사할 필요 없다</li>
<li>Page단위로 이루어짐</li>
<li>fork후에는 child 먼저 실행됨. child는 자신의 user stack에 쓰기를 할테니 fork직후에 필요한 페이지가 복사가 이루어질 것이다. 이것은 scheduling에서 다시 나옴</li>
</ul>
</li>
<li><code>vfork()</code>, <code>fork()</code> -&gt; <code>clone()</code> -&gt; <code>do_fork()</code></li>
</ul>
<h4 id="do_fork">do_fork()</h4>
<ul>
<li>자식용 PID 생성</li>
<li><code>copy_process()</code>를 이용해서 process descriptor 복사
<ul>
<li>thread_info, kernel stack 생성</li>
<li>최대 process 갯수 확인(생성 가능한 상태인지 확인)</li>
<li>descriptor, page table등등 복사</li>
<li>state = TASK_RUNNING</li>
<li>부모 관계 설정</li>
<li>thread group 관계 설정</li>
</ul>
</li>
<li>runqueue에 자식을 추가</li>
<li>(CLONE_VFORK일 경우) 부로를 wait queue에 넣음(vfork가 fork와 다른점 : block)</li>
<li>자식 PID를 반환하고 함수 종료</li>
</ul>
<h2 id="kernel-thread">Kernel Thread</h2>
<ul>
<li><strong>kernel-level threads와는 다른다, kernel-level threads와는!</strong></li>
<li>커널의 일부 함수(디스크 캐시 flush, swapping,&hellip;)를 kernel thread로 취급</li>
<li>커널 쓰레드를 lightweight process의 일종으로 구현
<ul>
<li>process descriptor, pid를 가진다</li>
<li><strong>스케줄링 가능</strong>하다. 프로세스처럼 취급</li>
<li><strong>kernel mode에서만 작동</strong>한다
<ul>
<li>user mode address space가 없다</li>
<li>3~4GB 영역의 메모리만 존재</li>
</ul>
</li>
<li>다른 커널 쓰레드와 kernel address space 공유</li>
<li>kernel data struct(ex: open file descriptor)도 공유</li>
</ul>
</li>
</ul>
<h2 id="process-0--swapper">Process 0 == Swapper</h2>
<ul>
<li><code>start_kernel()</code>로 생성됨</li>
<li>모든 커널 자료 구조 초기화</li>
<li>인터럽트 활성화</li>
<li>process 1 실행(이것도 커널 쓰레드)</li>
<li>process 1 생성후 <code>cpu_idle()</code> 호출하고 대기</li>
<li>TASK_RUNNING 상태의 프로세스가 없으면 스케줄러가 process 0 선택</li>
<li>각각의 CPU마다 process 0 존재</li>
</ul>
<h2 id="process-1--init">Process 1 == init</h2>
<ul>
<li>커널 완전히 초기화</li>
<li>다른 커널 쓰레드 생성(ex: ksoftirqd)</li>
<li>절대 죽지 않는다. 모든 프로세스 감시</li>
</ul>
<h2 id="프로세스-끝내기">프로세스 끝내기</h2>
<ul>
<li>프로세스 끝내는 방법
<ul>
<li>일반적인 방법 : <code>exit()</code></li>
<li>일반적인 방법 아님 : 시그널 보냄, SIGKILL</li>
</ul>
</li>
<li>프로세스 종료 : <code>do_exit()</code>
<ul>
<li>커널 자료구조 제거. <code>__exit_mm()</code>, <code>__exit_fs()</code>, &hellip;</li>
<li>부모관계 갱신</li>
<li>state = TASK_ZOMBIE</li>
<li><code>schedule()</code> 호출, 새로운 프로세스를 선택해서 실행</li>
</ul>
</li>
<li>프로세스 제거
<ul>
<li>부모가 <code>wait()</code>을 호출해서 종료값 읽기 전까지 지우지 않는다. 부모가 exit code를 읽으면 제거 가능</li>
<li><code>release_task()</code> : 좀비 프로세스의 PCB 해제</li>
<li>8KB 메모리 회수 : thread_info + kernel stack</li>
</ul>
</li>
</ul>

    </section>

    <ul class="articles-timeline">
      <li class="previous-article">
        
        <a href="https://libsora.so/posts/introduce-importd/" title="Next: importd - Django as a micro-framework">
          importd - Django as a micro-framework
          
          <br/><small>d is for django</small>
          
        </a>
        
      </li>

      <li class="next-article">
        
        <a href="https://libsora.so/posts/system-prog-linux-process-schduling/" title="Previous: Linux Process Scheduling">
          Linux Process Scheduling
          
          <br/><small>2014년 2학기 시스템 프로그래밍 시험 공부</small>
          
        </a>
        
      </li>
    </ul>

    <section class="entry-content">
      <section class="disqus-section">
<h1 hidden>Comment</h1>
<div id="disqus_thread"></div>
<script type="text/javascript">
  var host = "libsora.so";
  if (host == window.location.host) {
    var disqus_shortname = 'libsora';
    var disqus_identifier = 'http://libsora.so\/posts\/system-prog-linux-processes\/';

    (function() {
      var dsq = document.createElement('script');
      dsq.type = 'text/javascript';
      dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
  } else {
    console.log("skip disqus");
  }
</script>
<noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="//disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</section>

    </section>
  </article>
</div>

<footer class="footer">
  <ul class="nav-link-list">
    
    
    
    <li>
      
      <a href="//twitter.com/if1live" title="Twitter"><i class="fa fa-twitter"> </i></a>
    </li>
    
    
    
    <li>
      
      <a href="//github.com/if1live" title="GitHub"><i class="fa fa-github"> </i></a>
    </li>
    
    
    
    <li>
      
      <a href="//bitbucket.org/if1live" title="BitBucket"><i class="fa fa-bitbucket"> </i></a>
    </li>
    

    <li>
      
      <a href="https://libsora.so/index.xml"><i class="fa fa-rss"> </i></a>
    </li>

    
  </ul>

  <p>
    <a href="//gohugo.io/" title="Hugo">Hugo</a> |
    
    <a href="//twitter.com/if1live/" title="@if1live">@if1live</a>
    
  </p>
</footer>

<script src="/js/common.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.22.0/prism.min.js"
  integrity="sha512-9+422Bs3A87UkWfp+qV80Nfv9arhbCXKY1rxrF2seorI36mIIstMiuBfyKLF1yH1nnzQkEWq2xrzT4XU3Z+vrA=="
  crossorigin="anonymous"></script>


<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.22.0/plugins/line-numbers/prism-line-numbers.min.js"
  integrity="sha512-1oLZvExT5RaW4q2GgvRPf+XzVVGmsKirfZBRN7aifdOpvZ1L9idEncfMFlfHiQNGBA+Sev+alscSAT/xQ0rwXA=="
  crossorigin="anonymous"></script>


<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.22.0/components/prism-clike.min.js"
  integrity="sha512-/WJ9ZNER39LEXW4XzFoMR6ct++/HT++A71MDW2gBbUJExj8hFRtde5Q5QzcHyBMxU97VeH1wEHGBRtNuGJpV4w=="
  crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.22.0/components/prism-c.min.js"
  integrity="sha512-TO7UeOg1N67oP7UU2OzrOm0oZrTz2TXGNRtkf/x+d9Pt5O8cb5jeSRcryiXqW/Nd25VEc8Qqtu8Dx1EVV7AJLQ=="
  crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.22.0/components/prism-cpp.min.js"
  integrity="sha512-dzF2RO45FHCMPdWDQ3I7Cn9xPvCM8x8T4ODz+kSPQl5CAuIMy6Ekb2i2DAjLEpG/V/DL9f/O7+9E/HZQQx89IA=="
  crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.22.0/components/prism-typescript.min.js"
  integrity="sha512-5KnWNKu6jz8OE4nIBndz3PZ4O3RGqcPNcsyEFZkx3F5N8liSwc3bCe4qPOa/a3+e4CxVl0izHMXeZ0Z4yk7LTA=="
  crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.22.0/components/prism-python.min.js"
  integrity="sha512-EXseTM1JV8e3AonU5PfOUmzbPkUTRm4c4hVxv206gVeWZE/FwzSQBNWrUBaHsN3Idq9k76BEjUlXpluX1UFx6Q=="
  crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.22.0/components/prism-javascript.min.js"
  integrity="sha512-UN3RxBb1KfsWQUMNl19SU/JPer3v8jTBpfGyQaBEuaVjP5q0Gz9ihj8MiHEUZYnc1krYRm5imVebjq1egsSaKA=="
  crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.22.0/components/prism-java.min.js"
  integrity="sha512-p2vAaPEsPvlIESCpoEI5IyzZowfdVZ2O39PsrOrkuTQl+AjD57T4L/Wxv5S8WCToLou0twQZaWO+tt660Rqb6Q=="
  crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.22.0/components/prism-csharp.min.js"
  integrity="sha512-qvSIQfI/qEeMC1E1LMSPCsDl8vFzl0rkBfF6dDcnMJxQT+8M2WjSyDGqHQzZa+RChv3jkdKnZAo99BcAbGsnQg=="
  crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.22.0/components/prism-bash.min.js"
  integrity="sha512-CILPDr/8BlkkElCeI+f2yMu0fzgwWqpQ0Cdr0busFfySJJ4SoCRivbT6+Z+SWPkjWwBil9NO0tHd6NSfpwiQaA=="
  crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.22.0/components/prism-ruby.min.js"
  integrity="sha512-Wgi0cnFpl5EY8xLe1RO+uTsot86wzAbW/BIoqZopPU+8YW79VDqQE9qTe1R+1uhxLsPBHE+nYwACS+eTsE5GtQ=="
  crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.22.0/components/prism-go.min.js"
  integrity="sha512-hVtwzUDz/n7RqQmiQ7xYAJCTTJe5C52Ung+4Kpz2fPRq7nq2h5gHHQe2HRy7f1Tj3OUVgTO5WRx7XuwT624C9Q=="
  crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.22.0/components/prism-less.min.js"
  integrity="sha512-REVnwsprLWmQbtt0WjkS59nMvtKE0olIjUx+N/k3Gqa5WhmrZ7o0ahGhKYnIK6W2+ITg4cQ2UqZkka4RaZSM9Q=="
  crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.22.0/components/prism-scss.min.js"
  integrity="sha512-rAb9BrnkhMpxN7NoOM7WwPa3phfCMMUZw568Tyzlj9frNsdUUeltfCTATD6ccnVLtnERR+ZXS85Ybs7wo9IiTQ=="
  crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.22.0/components/prism-css.min.js"
  integrity="sha512-zDjwO/e5eVa5WfYra8CE827RFyA/nqhp8y4da+geEpAqpCnmfAHopCNobQ9sJeLBMQY0OLB+hT+k6bbb0FhdYQ=="
  crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.22.0/components/prism-json.min.js"
  integrity="sha512-IC7rV8RslChgByOdUFC6ePqOGn+OwJhnKC3S5AezM8DAiOdGhJMwgsIvBChsa2yuxxoPbH2+W/kjNUM1cc+jUQ=="
  crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.22.0/components/prism-yaml.min.js"
  integrity="sha512-j9sRnEoasdNn9OSwsCxjrQi1H55NqBFDJ+oe7me3sIfvDLeTyzvnZXf0eJqL5CvX6rswU2Sld9PnTVQ0Xy2CFQ=="
  crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.22.0/components/prism-batch.min.js"
  integrity="sha512-YzSVmlznJS4QEi5/tSS9iZ/tVFGdQSKO/F2jsofNH+5PifywJfsOtOZaia+URhumCMdXTTG2UZQ4vtBHWids+Q=="
  crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.22.0/components/prism-lisp.min.js"
  integrity="sha512-3c6jwEnUKsrvucb8b9xdDJw13zOdbeP83PvlSKeoTCCWGacG03MUWHCcBev2NKHA+w8IAWZsGXBcNMaIH/VWYA=="
  crossorigin="anonymous"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/mermaid/8.8.3/mermaid.min.js"
  integrity="sha512-+TNmhaRJf3jyYHTpzEq/5I6b+aGyhzWb21mGdHAjxSGSYwxN9Grug3Y3B9qVxWfKKY8MscE/6mr9walWvFLFvQ=="
  crossorigin="anonymous"></script>

<script>
  mermaid.initialize({ startOnLoad: true });

  (function () {
    const elems = document.querySelectorAll('code.language-mermaid');
    for (let i = 0; i < elems.length; i++) {
      const id = `mermaid-${i}`;
      const elem = elems[i];
      const source = elem.innerText;
      const cb = (svg) => {
        const div = document.createElement('div');
        div.innerHTML = svg;
        elem.parentElement.replaceWith(div);
      };
      mermaid.render(id, source, cb);
    }
  })();
</script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.js"
  integrity="sha512-/CMIhXiDA3m2c9kzRyd97MTb3MC6OVnx4TElQ7fkkoRghwDf6gi41gaT1PwF270W6+J60uTmwgeRpNpJdRV6sg=="
  crossorigin="anonymous"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/contrib/auto-render.min.js"
  integrity="sha512-Do7uJAaHZm5OLrIv/yN4w0iG1dbu01kzdMNnFfu/mAqgUk6Nniv2JYHcwH+cNwjqgLcqcuBBk+JRvprLVI8azg=="
  crossorigin="anonymous"></script>

<script>
  renderMathInElement(document.body,
    {
      delimiters: [
        { left: "$$", right: "$$", display: true },
        { left: "$", right: "$", display: false },
      ]
    }
  );

  var inlineMathArray = document.querySelectorAll("script[type='math/tex']");
  for (var i = 0; i < inlineMathArray.length; i++) {
    var inlineMath = inlineMathArray[i];
    var tex = inlineMath.innerText || inlineMath.textContent;
    var replaced = document.createElement("span");
    replaced.innerHTML = katex.renderToString(tex, { displayMode: false });
    inlineMath.parentNode.replaceChild(replaced, inlineMath);
  }

  var displayMathArray = document.querySelectorAll("script[type='math/tex; mode=display']");
  for (var i = 0; i < displayMathArray.length; i++) {
    var displayMath = displayMathArray[i];
    var tex = displayMath.innerHTML;
    var replaced = document.createElement("span");
    replaced.innerHTML = katex.renderToString(tex.replace(/%.*/g, ''), { displayMode: true });
    displayMath.parentNode.replaceChild(replaced, displayMath);
  }
</script>


<script>
  var host = "libsora.so";
  if (host == window.location.host) {
    window.ga=function(){ga.q.push(arguments)};ga.q=[];ga.l=+new Date;
    ga('create','UA-37862172-2','auto');ga('send','pageview')
  } else {
    console.log("skip google analytics");
  }
</script>
<script src="https://www.google-analytics.com/analytics.js" async defer></script>


</body>
</html>

